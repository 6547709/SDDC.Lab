{#
 #      Filename: templates/Pod_Doc.j2
 #    Created By: Luis Chanu & Rutger Blom
 #       Part Of: https://github.com/rutgerblom/SDDC.Lab
 #
 #}
<!DOCTYPE html>
<html>
<head>
<style>
table {
  table-layout: auto;
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 800px;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}

tr:nth-child(even) {
  background-color: #dddddd;
}
</style>
</head>
<body>
<h1>SDDC.Lab version {{ SDDCLab.Version }}</h1>

<h2>Documentation for Pod-{{Pod.Number}}</h2>

<p>Deployed by: {{ lookup('env','SUDO_USER') }}<br>
Deployed at: {{ time }}<br>
Deploy target: {{ Target.FQDN }}<br>
IP stacks used:{% if Deploy.Settings.IPv4 %}IPv4{% endif %}{# Deploy.Settings.IPv4 #}{% if Deploy.Settings.IPv6 %} IPv6{% endif %}{# Deploy.Settings.IPv6 #}</p>
  
<h3>Links</h3>
<table>
  <tr>
    <th>Description</th>
    <th>Link</th>
  </tr>
  <tr>
    <td>vCenter</td>
    <td><a href="https://{{ Nested_vCenter.FQDN }}">https://{{ Nested_vCenter.FQDN }}</a></td>
  </tr>
{% if Deploy.Products.NSXT.GlobalManager == True %}
  <tr>
    <td>NSX-T Global Manager</td>
    <td><a href="https://{{ Nested_NSXT.Components.GlobalManager.FQDN }}">https://{{ Nested_NSXT.Components.GlobalManager.FQDN }}</a>/</td>
  </tr>
{% endif %}{# Deploy.Products.NSXT.GlobalManager #}
{% if Deploy.Products.NSXT.LocalManager == True %}
  <tr>
    <td>NSX-T Local Manager</td>
    <td><a href="https://{{ Nested_NSXT.Components.LocalManager.FQDN }}">https://{{ Nested_NSXT.Components.LocalManager.FQDN }}</a>/</td>
  </tr>
{% endif %}{# Deploy.Products.NSXT.LocalManager #}
{% if Deploy.Products.vRLI == True %}
  <tr>
    <td>vRealize Log Insight</td>
    <td><a href="https://{{ Nested_vRLI.FQDN }}">https://{{ Nested_vRLI.FQDN }}</a>/</td>
  </tr>
  <tr>
    <td>vCenter VAMI</td>
    <td><a href="https://{{ Nested_vCenter.FQDN }}:5480">https://{{ Nested_vCenter.FQDN }}:5480</a></td>
  </tr>
{% endif %}{# Deploy.Products.vRLI #}
{% if Deploy.Products.NSXT.GlobalManager == True %}
  <tr>
    <td>NSX-T Global Manager CLI</td>
    <td><a href="ssh://{{ Nested_NSXT.Components.GlobalManager.FQDN }}">ssh://{{ Nested_NSXT.Credential.admin.Name }}@{{ Nested_NSXT.Components.LocalManager.FQDN }}</a>/</td>
  </tr>
{% endif %}{# Deploy.Products.NSXT.GlobalManager #}
{% if Deploy.Products.NSXT.LocalManager == True %}
  <tr>
    <td>NSX-T Local Manager CLI</td>
    <td><a href="ssh://{{ Nested_NSXT.Components.LocalManager.FQDN }}">ssh://{{ Nested_NSXT.Credential.admin.Name }}@{{ Nested_NSXT.Components.LocalManager.FQDN }}</a>/</td>
  </tr>
{% endif %}{# Deploy.Products.NSXT.LocalManager #}
{% if Deploy.Products.NSXT.Edge %}
{% for EdgeTransportNode in Nested_NSXT.System.Fabric.Nodes.EdgeTransportNodes %}
  <tr>
    <td>{{ EdgeTransportNode.Name }} CLI</td>
    <td><a href="ssh://{{ EdgeTransportNode.Deployment.Hostname }}">ssh://{{ Nested_NSXT.Credential.admin.Name }}@{{ EdgeTransportNode.Deployment.Hostname }}</a>/</td>
  </tr>
{% endfor %}{# EdgeTransportNode #}
{% endif %}{# Deploy.Products.NSXT.Edge #}
  <tr>
    <td>vCenter CLI</td>
    <td><a href="ssh://root@{{ Nested_vCenter.FQDN }}">ssh://root@{{ Nested_vCenter.FQDN }}</a></td>
  </tr>
{% if Deploy.Products.Router == True %}
  <tr>
    <td>VyOS Router CLI</td>
{% if Deploy.Settings.IPv4 %}
    <td><a href="ssh://vyos@{{ Nested_Router.Interface.Management.IPv4.Address }}">ssh://vyos@{{ Nested_Router.Interface.Management.IPv4.Address }}</a></td>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <td><a href="ssh://vyos@{{ Nested_Router.Interface.Management.IPv6.Address }}">ssh://vyos@{{ Nested_Router.Interface.Management.IPv6.Address }}</a></td>
{% endif %}{# Deploy.Settings.IPv4 #}
  </tr>
{% endif %}{# Deploy.Products.Router #}
</table>
<br>

<h3>Credentials</h3>
<table>
  <tr>
    <th>Description</th>
    <th>Username</th>
    <th>Password</th>
  </tr>
  <tr>
    <td>vCenter</td>
    <td>{{ Nested_vCenter.User }}</td>
    <td>{{ Nested_vCenter.Password }}</td>
  </tr>
  <tr>
    <td>ESXi</td>
    <td>root</td>
    <td>{{ Common.Password.Nested }}</td>
  </tr>
{% if Deploy.Products.NSXT.LocalManager == True %}
  <tr>
    <td>NSX-T Admin</td>
    <td>{{ Nested_NSXT.Credential.admin.Name }}</td>
    <td>{{ Nested_NSXT.Credential.admin.Password }}</td>
  </tr>
  <tr>
    <td>NSX-T Audit</td>
    <td>{{ Nested_NSXT.Credential.audit.Name }}</td>
    <td>{{ Nested_NSXT.Credential.audit.Password }}</td>
  </tr>
  <tr>
    <td>NSX-T Root</td>
    <td>{{ Nested_NSXT.Credential.root.Name }}</td>
    <td>{{ Nested_NSXT.Credential.root.Password }}</td>
  </tr>
{% endif %}{# Deploy.Products.NSXT.LocalManager #}
{% if Deploy.Products.vRLI == True %}
  <tr>
    <td>vRealize Log Insight Admin</td>
    <td>{{ Nested_vRLI.Credential.admin.Name }}</td>
    <td>{{ Nested_vRLI.Credential.admin.Password }}</td>
  </tr>
  <tr>
    <td>vRealize Log Insight Root</td>
    <td>{{ Nested_vRLI.Credential.root.Name }}</td>
    <td>{{ Nested_vRLI.Credential.root.Password }}</td>
  </tr>
{% endif %}{# Deploy.Products.vRLI #}
  <tr>
    <td>vCenter VAMI and CLI</td>
    <td>root</td>
    <td>{{ Nested_vCenter.Password }}</td>
  </tr>
{% if Deploy.Products.Router == True %}
  <tr>
    <td>VyOS Router CLI</td>
    <td>vyos</td>
    <td>{{ Common.Password.Nested }}</td>
  </tr>
{% endif %}{# Deploy.Products.Router #}
</table>
<br>
{% if Deploy.Products.Router == True %}
<h3>VLANs</h3>
<table>
  <tr>
    <th>VLAN Description</th>
    <th>VLAN ID</th>
    <th>CIDR</th>
{% if Deploy.Settings.IPv4 %}
    <th>Gateway4</th>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <th>Gateway6</th>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
  <tr>
    <td>Management</td>
    <td>{{ Nested_Router.Interface.Management.VLAN }}</td>
{% if Deploy.Settings.IPv4 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.Management.IPv4.Address, Nested_Router.Interface.Management.IPv4.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.Management.IPv4.Address }}</td>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.Management.IPv6.Address, Nested_Router.Interface.Management.IPv6.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.Management.IPv6.Address }}</td>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
  <tr>
    <td>vMotion</td>
    <td>{{ Nested_Router.Interface.vMotion.VLAN }}</td>
{% if Deploy.Settings.IPv4 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.vMotion.IPv4.Address, Nested_Router.Interface.vMotion.IPv4.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.vMotion.IPv4.Address }}</td>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.vMotion.IPv6.Address, Nested_Router.Interface.vMotion.IPv6.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.vMotion.IPv6.Address }}</td>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
  <tr>
    <td>vSAN</td>
    <td>{{ Nested_Router.Interface.vSAN.VLAN }}</td>
{% if Deploy.Settings.IPv4 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.vSAN.IPv4.Address, Nested_Router.Interface.vSAN.IPv4.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.vSAN.IPv4.Address }}</td>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.vSAN.IPv6.Address, Nested_Router.Interface.vSAN.IPv6.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.vSAN.IPv6.Address }}</td>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
  <tr>
    <td>IP Storage</td>
    <td>{{ Nested_Router.Interface.IPStorage.VLAN }}</td>
{% if Deploy.Settings.IPv4 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.IPStorage.IPv4.Address, Nested_Router.Interface.IPStorage.IPv4.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.IPStorage.IPv4.Address }}</td>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.IPStorage.IPv6.Address, Nested_Router.Interface.IPStorage.IPv6.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.IPStorage.IPv6.Address }}</td>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
  <tr>
    <td>Transport</td>
    <td>{{ Nested_Router.Interface.Transport.VLAN }}</td>
{% if Deploy.Settings.IPv4 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.Transport.IPv4.Address, Nested_Router.Interface.Transport.IPv4.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.Transport.IPv4.Address }}</td>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.Transport.IPv6.Address, Nested_Router.Interface.Transport.IPv6.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.Transport.IPv6.Address }}</td>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
  <tr>
    <td>Service VM Management</td>
    <td>{{ Nested_Router.Interface.ServiceVM.VLAN }}</td>
{% if Deploy.Settings.IPv4 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.ServiceVM.IPv4.Address, Nested_Router.Interface.ServiceVM.IPv4.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.ServiceVM.IPv4.Address }}</td>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.ServiceVM.IPv6.Address, Nested_Router.Interface.ServiceVM.IPv6.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.ServiceVM.IPv6.Address }}</td>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
  <tr>
    <td>NSX Edge Uplink 1</td>
    <td>{{ Nested_Router.Interface.NSXEdgeUplink1.VLAN }}</td>
{% if Deploy.Settings.IPv4 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.NSXEdgeUplink1.IPv4.Address, Nested_Router.Interface.NSXEdgeUplink1.IPv4.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.NSXEdgeUplink1.IPv4.Address}}</td>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.NSXEdgeUplink1.IPv6.Address, Nested_Router.Interface.NSXEdgeUplink1.IPv6.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.NSXEdgeUplink1.IPv6.Address}}</td>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
  <tr>
    <td>NSX Edge Uplink 2</td>
    <td>{{ Nested_Router.Interface.NSXEdgeUplink2.VLAN }}</td>
    <td>{{ "{}/{}".format(Nested_Router.Interface.NSXEdgeUplink2.IPv4.Address, Nested_Router.Interface.NSXEdgeUplink2.IPv4.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.NSXEdgeUplink2.IPv4.Address }}</td>
  </tr>
  <tr>
    <td>RTEP</td>
    <td>{{ Nested_Router.Interface.RTEP.VLAN }}</td>
{% if Deploy.Settings.IPv4 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.RTEP.IPv4.Address, Nested_Router.Interface.RTEP.IPv4.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.RTEP.IPv4.Address }}</td>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.RTEP.IPv6.Address, Nested_Router.Interface.RTEP.IPv6.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.RTEP.IPv6.Address }}</td>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
    <tr>
    <td>VM Network</td>
    <td>{{ Nested_Router.Interface.VMNetwork.VLAN }}</td>
{% if Deploy.Settings.IPv4 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.VMNetwork.IPv4.Address, Nested_Router.Interface.VMNetwork.IPv4.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.VMNetwork.IPv4.Address }}</td>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <td>{{ "{}/{}".format(Nested_Router.Interface.VMNetwork.IPv6.Address, Nested_Router.Interface.VMNetwork.IPv6.Prefix) | ipaddr('network/prefix') }}</td>
    <td>{{ Nested_Router.Interface.VMNetwork.IPv6.Address }}</td>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
</table>
<br>
{% endif %}{# Deploy.Products.Router #}

<h3>FQDNs and IP addresses</h3>
<table>
  <tr>
    <th>FQDN</th>
    <th>IPv4 address</th>
{% if Deploy.Settings.IPv6 %}
    <th>IPv6 address</th>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
  <tr>
    <td>{{ Nested_vCenter.FQDN }}</td>
{% if Deploy.Settings.IPv4 %}
    <td>{{ Nested_vCenter.Address.IPv4.Address }}</td>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <td>{{ Nested_vCenter.Address.IPv6.Address }}</td>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
{% if Deploy.Products.vRLI == True %}
  <tr>
    <td>{{ Nested_vRLI.FQDN }}</td>
{% if Deploy.Settings.IPv4 %}
    <td>{{ Nested_vRLI.Address.IPv4.Address }}</td>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <td>{{ Nested_vRLI.Address.IPv6.Address }}</td>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
{% endif %}{# Deploy.Products.vRLI #}
{% if Deploy.Products.NSXT.GlobalManager == True %}
  <tr>
    <td>{{ Nested_NSXT.Components.GlobalManager.FQDN }}</td>
{% if Deploy.Settings.IPv4 %}
    <td>{{ Nested_NSXT.Components.GlobalManager.Address.IPv4.Address }}</td>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <td>{{ Nested_NSXT.Components.GlobalManager.Address.IPv6.Address }}</td>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
{% endif %}{# Deploy.Products.NSXT.GlobalManager #}
{% if Deploy.Products.NSXT.LocalManager == True %}
  <tr>
    <td>{{ Nested_NSXT.Components.LocalManager.FQDN }}</td>
{% if Deploy.Settings.IPv4 %}
    <td>{{ Nested_NSXT.Components.LocalManager.Address.IPv4.Address }}</td>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <td>{{ Nested_NSXT.Components.LocalManager.Address.IPv6.Address }}</td>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
{% endif %}{# Deploy.Products.NSXT.LocalManager #}
{% if Deploy.Products.NSXT.CloudServicesManager == True %}
  <tr>
    <td>{{ Nested_NSXT.Components.CloudServicesManager.FQDN }}</td>
{% if Deploy.Settings.IPv4 %}
    <td>{{ Nested_NSXT.Components.CloudServicesManager.Address.IPv4.Address }}</td>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <td>{{ Nested_NSXT.Components.CloudServicesManager.Address.IPv6.Address }}</td>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
{% endif %}{# Deploy.Products.NSXT.CloudServicesManager #}
{% for item in Nested_ESXi.Hosts %}
  <tr>
    <td>{{ Nested_ESXi.Hosts[item].FQDN }}</td>
{% if Deploy.Settings.IPv4 %}
    <td>{{ Nested_ESXi.Hosts[item].vmk.vmk0.Address.IPv4.Address }}</td>
{% endif %}{# Deploy.Settings.IPv4 #}
{% if Deploy.Settings.IPv6 %}
    <td>{{ Nested_ESXi.Hosts[item].vmk.vmk0.Address.IPv6.Address }}</td>
{% endif %}{# Deploy.Settings.IPv6 #}
  </tr>
{% endfor %}
{% if Deploy.Products.NSXT.Edge %}
{% for EdgeTransportNode in Nested_NSXT.System.Fabric.Nodes.EdgeTransportNodes %}
  <tr>
    <td>{{ EdgeTransportNode.Deployment.Hostname }}</td>
    <td>{{ EdgeTransportNode.Deployment.ManagementIPAddress }}</td>
  </tr>
{% endfor %}{# EdgeTransportNode #}
{% endif %}{# Deploy.Products.NSXT.Edge #}
</table>

</body>
</html>
